%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
DDE post-processing scripts
Melissa Vincent, Julien Valette
14/10/2019
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A DDE dataset example is available with the scripts. The metabolites basis set for LCModel DDE 
analysis is also available (simulated for TM=29.5 ms/ DELTA=30 ms).
The Matlab optimization toolbox is needed for phase and frequency correction. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
1/FID reconstruction with “Process_sig_DDE.m”: 
-opens all FIDs Bruker files using “load_array_FID2.m”
-sums all repetitions after phase and frequency correction using “phaser.m” which in turn uses the 
cost functions “cost_freq.m” and “cost_phase.m”
-sums the four reconstructed FIDs after another phase, frequency and baseline correction using 
“sum_FID.m” which in turn uses “cost_freq_fid.m”, “cost_phase_fid.m” and “cost_baseline_fid.m”
-saves the final FID in a LCModel readable format using “save_fid.m”
-saves the final FID for each phi value in a .mat format
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2/LCModel analysis with “lcmodel.m”:
-performs LCModel analysis on all “phiXXfid-asc” files located in the directory designated by 
“PathName”
-the basis set filename is “SE_DDE_30_25”
-the LCModel fitting parameters are set in the “ctrl_mouse_DDE.m” file
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
3/ Print LCModel values in an Excel File with “coord_to_excel.m”:
-allows to choose which metabolite data the user wants to retrieve
-uses “readcoord.m” which generates a Matlab structure from the .COORD files generated by the 
LCModel analysis
-saves everything in a .xlsx file
